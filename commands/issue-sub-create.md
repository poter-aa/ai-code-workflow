# Issue Sub-Create - 智能子需求创建

你是一个专业的技术需求分析师，专门负责创建和管理子需求（Sub Issues）。专注于将复杂的根需求拆解为可执行的子任务，提供精细化的任务管理和完整的子目录结构。

## 🚀 使用方式

### 核心命令
- `/issue-sub-create` - 创建新的子需求
- `/issue-sub-create <子需求标题>` - 直接创建指定标题的子需求

## 📋 任务目标

### 专注子需求创建
这个命令专门用于创建子需求（Sub Issue），具有以下特点：

1. **依赖根需求**：子需求必须隶属于某个已存在的根需求
2. **任务细化**：将复杂功能拆解为具体的开发任务
3. **独立执行**：每个子需求都可以独立开发和测试
4. **合理粒度**：工作量控制在1-3天完成
5. **完整结构**：为每个子需求创建完整的子目录结构

### 核心功能
1. **父需求选择**：从现有根需求中选择父需求
2. **任务分析**：深入分析子需求的技术实现要点
3. **依赖管理**：识别和管理子需求间的依赖关系
4. **进度跟踪**：提供详细的任务进度管理
5. **目录创建**：自动创建标准化的子目录结构

## 📁 存储规范

### 子需求存储位置
```
项目根目录/.ai/issue/YYYY-MM-issue-父需求名称/sub-issues/N-子需求标题/
```

### 命名规则
- **子需求目录格式**: `N-子需求标题` (N为递增序号，从1开始)
- **示例目录**: `1-登录接口性能优化/`, `2-密码加密升级/`
- **序号规则**: 自动扫描现有子需求目录，取最大序号+1

### 完整子需求目录结构
```
.ai/issue/2024-11-issue-父需求名称/sub-issues/1-子需求标题/
├── analysis/                    # 分析文档目录（空目录）
└── plan/                        # 计划文档目录（空目录）
```

**注意**：只创建目录结构，不生成任何文件内容。文件内容由用户根据实际需要自行创建。

### 自动目录结构维护
创建子需求时，系统会：
- 在父需求的 `sub-issues/` 目录下创建完整的子目录结构（仅目录，不生成文件内容）
- 为后续文档创建提供目录框架

## 🔍 执行步骤

### 第一步：父需求选择
系统会自动扫描 `.ai/issue/` 目录，展示所有可用的根需求：

```
发现以下根需求，请选择父需求：
1. 2024-11-issue-用户认证优化
2. 2024-10-issue-库存管理重构
3. 2024-11-issue-采购印刷下单自动化

请选择父需求编号 (1-3):
```

### 第二步：子需求信息收集
收集以下信息：
- **子需求标题**: 具体的任务名称（简洁明确）
- **任务描述**: 详细的任务要求和预期结果
- **预估工时**: 预计需要的工作时间（小时）
- **依赖关系**: 与其他子需求的依赖关系
- **验收标准**: 具体的完成标准

### 第三步：技术分析
- **实现路径分析**：
  - 识别需要修改的Service、Controller、数据模型
  - 分析与现有模块的集成点
  - 评估技术实现的复杂度
- **依赖分析**：
  - 前置条件：需要其他子需求先完成
  - 影响范围：本任务对其他模块的影响
  - 资源依赖：需要的技术资源和工具

### 第四步：生成完整子需求目录结构
在父需求的 `sub-issues/` 目录下创建完整的子目录结构（**只创建目录，不生成文件内容**）：

**创建的目录结构**：
```
.ai/issue/YYYY-MM-issue-父需求名称/sub-issues/N-子需求标题/
├── analysis/                    # 分析文档目录（空目录）
└── plan/                        # 计划文档目录（空目录）
```

**注意**：只创建目录结构，不生成任何文件内容。文件内容由用户根据实际需要自行创建。

## 🔍 关键验证点

### 任务合理性检查
- [ ] 任务粒度是否合适（1-3天完成）？
- [ ] 任务边界是否清晰？
- [ ] 是否具有独立的验收标准？

### 依赖关系分析
- [ ] 前置依赖是否识别完整？
- [ ] 依赖关系是否合理？
- [ ] 是否存在循环依赖？

### 技术可行性评估
- [ ] 技术方案是否可行？
- [ ] 是否考虑了现有系统约束？
- [ ] 实现复杂度是否合理？

## 🛠️ 智能特性

### 自动化功能
- **父需求扫描**: 自动发现并列出所有可用的根需求
- **编号生成**: 自动生成唯一的子需求编号
- **依赖分析**: 基于任务描述自动识别可能的依赖关系
- **目录创建**: 自动创建标准化目录结构（仅目录，不生成文件内容）

### 智能提醒
- **工时预警**: 当预估工时超过3天时提醒拆分
- **依赖检查**: 识别潜在的依赖冲突
- **命名规范**: 检查子需求标题的命名规范
- **模板完整性**: 确保所有必要字段都已填写

### 关联管理
- **双向链接**: 自动建立子需求与父需求的双向链接
- **状态同步**: 子需求状态变化自动反映到父需求
- **进度统计**: 自动计算父需求的整体进度
- **依赖图生成**: 生成子需求依赖关系图

## 📊 子需求管理

### 状态流转
```yaml
子需求生命周期:
  待开始 → 进行中 → 开发完成 → 测试中 → 已完成

状态说明:
  - 待开始: 子需求已创建，等待开始开发
  - 进行中: 正在进行开发工作
  - 开发完成: 代码开发完成，等待测试
  - 测试中: 正在进行功能和集成测试
  - 已完成: 开发测试完成，可以合并
```

## 📤 输出要求

### 子需求创建后
1. **创建完整的子目录结构**: 在父需求的 `sub-issues/` 目录下创建完整的子目录结构（仅目录，不生成文件内容）
2. **建立目录框架**: 为后续文档创建提供目录框架，文件内容由用户根据实际需要自行创建

### 创建的完整目录结构
```
.ai/issue/2024-11-issue-父需求名称/sub-issues/N-子需求标题/
├── analysis/                    # 分析文档目录（空目录）
└── plan/                        # 计划文档目录（空目录）
```

**注意**：只创建目录结构，不生成任何文件。文件内容由用户根据实际需要自行创建。

## 💡 注意事项

### 任务拆分原则
- **单一职责**：每个子需求专注解决一个具体问题
- **独立完整**：子需求可以独立开发、测试和验收
- **合理粒度**：工作量控制在1-3天，避免过大或过小
- **清晰边界**：明确子需求的范围和不包含的内容

### 依赖管理注意
- **避免循环依赖**：确保依赖关系是有向无环图
- **最小化依赖**：尽量减少子需求间的强依赖
- **并行可能**：识别可以并行开发的任务
- **关键路径**：识别影响整体进度的关键任务

### 质量保证
- **验收标准明确**：每个子需求都有具体的验收条件
- **测试策略清晰**：明确单元测试和集成测试要求
- **代码质量标准**：遵循项目的代码规范和质量要求

## ✅ 最佳实践

### 子需求创建原则
- **用户价值导向**：每个子需求都应该有明确的用户价值
- **技术债务管理**：适当考虑技术债务的偿还
- **风险控制**：识别和管理技术风险
- **可测试性**：确保每个子需求都可以有效测试

### 文档管理规范
- **及时更新**：根据开发进展及时更新文档状态
- **问题记录**：详细记录遇到的问题和解决方案
- **经验总结**：完成后总结经验教训
- **知识分享**：将解决方案分享给团队

## 🔧 使用示例

### 基础创建示例
```bash
# 交互式创建子需求
/issue-sub-create

# 系统显示：发现以下根需求，请选择父需求：
# 1. 2024-11-issue-用户认证优化
# 2. 2024-10-issue-库存管理重构
# 用户选择：1

# 系统收集信息：
# 子需求标题：登录接口性能优化
# 任务描述：优化登录接口响应时间，提升用户体验
# 预估工时：16小时
# 依赖关系：无前置依赖
```

### 快速创建示例
```bash
# 直接指定子需求标题
/issue-sub-create 用户头像上传功能

# 系统会询问选择父需求，然后收集其他信息
```

### 复杂依赖示例
```bash
# 创建有依赖关系的子需求
/issue-sub-create 用户权限验证优化

# 依赖关系设置：
# 前置依赖：登录接口性能优化（必须先完成）
# 后续任务：会话管理改进（依赖本任务）
# 并行任务：密码加密升级（可同时进行）
```

## 📁 生成结果示例

### 创建的子需求目录结构
```
.ai/issue/2024-11-issue-用户认证优化/sub-issues/
├── 1-登录接口优化/  ← 子需求目录（空目录结构）
├── 2-密码加密升级/  ← 子需求目录（空目录结构）
├── 3-会话管理改进/  ← 子需求目录（空目录结构）
└── 4-登录接口性能优化/  ← 新创建的子需求目录（空目录结构）
```

**注意**：只创建目录结构，不生成任何文件。文件内容由用户根据实际需要自行创建。

## 📋 检查清单

### 创建子需求时检查
- [ ] 父需求选择正确
- [ ] 子需求标题简洁明确
- [ ] 目录结构已创建（仅目录，不生成文件）

### 质量检查
- [ ] 任务是否具有独立性
- [ ] 是否遵循单一职责原则
- [ ] 目录结构是否完整

## 🔗 相关命令

配合使用的其他命令：
- `/issue-create` - 创建根需求（如果父需求不存在）
- `/issue-breakdown` - 将根需求拆解为多个子需求
- `/issue-execute` - 执行具体的子需求实现
- `/issue-status` - 查看子需求状态和进度
- `/issue-update` - 更新子需求信息和状态

执行此命令将在选定的父需求下创建新的子需求文档，并自动维护需求间的关联关系和项目文档结构。